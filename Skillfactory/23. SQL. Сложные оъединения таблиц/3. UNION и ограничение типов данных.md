# Почему так важен тип данных?

*Как мы уже знаем, UNION может быть использован только в случае полного соответствия столбцов и их типов в объединяемых запросах.*

*Допустим, мы хотим вывести список всех id городов и их названий в одном столбце.*

*Давайте напишем запрос, который позволит получить нужный нам результат.*

**SELECT 
c.city_id
FROM
sql.city c
UNION ALL
SELECT 
cc.city_name
FROM
sql.city cc**

*Вместо результата вы получите сообщение об ошибке: "ERROR: UNION types integer and text cannot be matched". Дело в том, что мы попытались объединить числовой и строковый типы в одной колонке, а это невозможно.*

***Если мы всё же хотим выполнить поставленную задачу, придётся привести оба столбца к одному типу данных. Не каждый текст может быть приведён к числу, зато каждое число может быть представлено в текстовом формате.***

*Забегая вперёд, скажем пару слов о типизации столбцов. Для типизации в Postgres составляется запрос по модели column_name::column_type.*

*Таким образом, чтобы перевести city_id в текст, нам потребуется написать city_id::text.*

***Важно!*** *Любой тип данных может быть приведён к текстовому формату — эту возможность целесообразно использовать для соединения разнородных сущностей. Главное — помнить, что сортировка текста отличается от сортировки чисел и дат.**

*Немного подправим запрос, чтобы получить желаемый результат.*

**SELECT 
c.city_id::text
FROM
sql.city c
UNION ALL
SELECT 
cc.city_name
FROM
sql.city cc**

### Задание 3.1

*Напишите запрос, который объединит в себе все почтовые индексы водителей и их телефоны в единый столбец-справочник contact. Также добавьте столбец с именем водителя first_name и столбец contact_type с типом контакта (phone или zip в зависимости от типа). Отсортируйте список по столбцу с контактными данными в порядке возрастания, а затем — по имени водителя.*

**SELECT
    d.zip_code::text contact,
    d.first_name first_name,
    'zip' contact_type
FROM
    sql.driver d
UNION
SELECT
    dd.phone contact,
    dd.first_name first_name,
    'phone' contact_type
FROM
    sql.driver dd
ORDER BY 1,2**