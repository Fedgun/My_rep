# Вы познакомились с агрегатными функциями и научились:
- считать количество строк, сумму, минимум, максимум, среднее по значениям таблицы;
- выводить агрегированные значения в разных разрезах;
- фильтровать по агрегированным значениям.

*И в довершение итогов напомним структуру запроса, который мы можем составить с учётом новых знаний:*

**SELECT
    столбец1 AS новое_название,
    столбец2,
    АГРЕГАТ(столбец3)
FROM таблица
WHERE (условие1 OR условие2)
    AND условие3
GROUP BY столбец1, столбец2
HAVING АГРЕГАТ(столбец3) > 5
ORDER BY сортировка1, сортировка2
OFFSET 1 LIMIT 2**

### Задание 6.1
***Сколько различных значений показателей атаки есть у покемонов с типом Water (основным или дополнительным)?***

**SELECT
    count(distinct attack) as count_a
from sql.pokemon
where type1 = 'Water' or type2 = 'Water'**

### Задание 6.2 

***Напишите запрос, который выведет основной и дополнительный типы покемонов и средние значения по каждому показателю (столбцы avg_hp, avg_attack, avg_defense, avg_speed).Оставьте только те пары типов, у которых сумма этих четырёх показателей более 400.***

**SELECT
    type1,
    type2,
    avg(hp) as avg_hp,
    avg(attack) as avg_attack,
    avg(defense) as avg_defense,
    avg(speed) as avg_speed
FROM sql.pokemon
GROUP BY type1, type2
HAVING (AVG(hp) + AVG(attack) + AVG(defense) + AVG(speed)) > 400**

### Задание 6.3 

***Напишите запрос, который выведет столбцы с основным типом покемона и общим количеством покемонов этого типа. Учитывайте только тех покемонов, у кого или показатель атаки, или показатель защиты принимает значение между 50 и 100 включительно. Оставьте только те типы покемонов, у которых максимальный показатель здоровья не больше 125. Выведите только тот тип, который находится на пятом месте по количеству покемонов.***

**SELECT
    type1,
    count(type1) as c_type1
FROM sql.pokemon
where (defense >= 50 and defense <= 100) or (attack >= 50 and attack <= 100)
group by type1
having max(hp) <= 125
order by c_type1 DESC
offset 4 limit 1**